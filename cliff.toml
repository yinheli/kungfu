[git]
commit_parsers = [
  { message = "^feat", group = "<!-- 0 -->ğŸš€ Features" },
  { message = "^fix", group = "<!-- 1 -->ğŸ› Bug Fixes" },
  { message = "^doc", group = "<!-- 3 -->ğŸ“ Documentation" },
  { message = "^perf", group = "<!-- 4 -->âš¡ Performance" },
  { message = "^refactor", group = "<!-- 2 -->ğŸ—ï¸ Refactor" },
  { message = "^style", group = "<!-- 5 -->ğŸ¨ Styling" },
  { message = "^test", group = "<!-- 6 -->âœ… Testing" },
  { message = "^chore\\(release\\): prepare for", skip = true },
  { message = "^chore\\(deps\\)", skip = true },
  { message = "^chore", group = "<!-- 7 -->âš™ï¸ Miscellaneous Tasks" },
  { body = ".*security", group = "<!-- 8 -->ğŸ”’ Security" },
]

filter_commits = true
tag_pattern = "v[0-9]*"
# protect commits from being skipped due to matching skip patterns
protect_breaking_commits = true
# sort the commits inside sections by oldest/newest order
sort_commits = "oldest"

[changelog]
# changelog header
header = """
# Changelog
All notable changes to this project will be documented in this file.

"""
# template for the changelog body
# https://keats.github.io/tera/docs/#introduction
body = """
{% if version -%}
    ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else -%}
    ## [Unreleased]
{% endif -%}
{% for group, commits in commits | group_by(attribute="group") %}
    {{ group | trim_start_matches(pat="<!-- ") | trim_end_matches(pat=" -->") | upper_first }}
    {% for commit in commits %}
        - {% if commit.breaking -%}
            {% raw %}**BREAKING:** {% endraw %}\
        {% endif -%}
            {{ commit.message | upper_first }}\
            {% if commit.remote.github.username %} by @{{ commit.remote.github.username }}{%- endif -%}
            {% if commit.remote.github.pr_number %} in #{{ commit.remote.github.pr_number }}{%- endif -%}
    {% endfor %}
{% endfor %}

{% if github -%}
{% if github.contributors %}
    ## âœ¨ New Contributors â¤ï¸
    {% for contributor in github.contributors %}
        - @{{ contributor.username }} made their first contribution in #{{ contributor.pr_number }}
    {% endfor %}
{% endif -%}{% endif -%}

{% if previous.version -%}
    **Full Changelog**: https://github.com/{{ remote.github.owner }}/{{ remote.github.repo }}/compare/{{ previous.version }}...{{ version }}
{% endif %}
"""
# remove the leading and trailing whitespace from the template
trim = true
# changelog footer
footer = """
<!-- generated by git-cliff -->
"""

[bump]
features_always_bump = true
breaking_always_bump = true

[remote.github]
owner = "yinheli"
repo = "kungfu"